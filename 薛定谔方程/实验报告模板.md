# 薛定谔方程 - 实验报告

## 1. 实验目的简述

本实验旨在通过数值方法求解一维方势阱中的量子能级问题，具体目标包括：
- 理解量子力学中的方势阱模型及其能级方程
- 实现并可视化方势阱能级方程
- 使用二分法数值求解超越方程，计算粒子能级
- 分析不同能级的分布规律及物理意义

## 2. 方法简述

请简要描述您实现的算法和方法，特别是：
- 如何处理方程中的数值计算问题（如避免过小数值导致的计算误差）
- 二分法求解超越方程的具体实现策略
- 如何区分和处理偶宇称和奇宇称能级

- 本程序用于求解一维有限深方势阱中的能级问题。针对数值计算，首先将所有能量单位统一为焦耳，避免因能量过小导致的下溢或除零错误，并通过 np.errstate 屏蔽无效操作和溢出警告，对无效结果用 np.nan 处理，保证后续计算稳定。
- 在能级方程的求解中，采用二分法寻找超越方程的根。具体做法是：首先判断用户给定的能量区间端点函数值是否异号，若异号则直接在该区间内用二分法求根；若同号，则自动在区间内扫描所有根，并选择第 n 个根作为目标区间。二分法过程中，每次迭代都检查中点函数值与区间端点的符号，逐步缩小区间，直到满足精度要求。
- 对于偶宇称和奇宇称能级，分别构造不同的超越方程：偶宇称能级对应 $$y_1 - y_2 = 0$$，奇宇称能级对应 $$y_1 - y_3 = 0$$，通过能级编号的奇偶性自动选择相应的方程进行求解。这样既保证了物理模型的准确性，也提高了算法的健壮性和适用性_

## 3. 实验结果

### 3.1 能级方程可视化

请在此处粘贴您生成的能级方程图像，并简要说明图中各曲线的物理意义以及能级对应的交点位置。

_在此处插入能级方程图像_

图像说明：
- 蓝色实线： $$y_1 = \tan\sqrt{w^2 m E / 2\hbar^2}$$这是方势阱能级方程左侧的函数，反映了井内波函数的边界条件。
- 红色虚线： $$y_2 = \sqrt{(V-E)/E}$$ (even parity)这是偶宇称（对称）能级对应的右侧函数，描述了井外波函数的衰减特性。
- 绿色点划线： $$y_3 = -\sqrt{E/(V-E)}$$ (odd parity)这是奇宇称（反对称）能级对应的右侧函数，同样描述井外波函数，但适用于奇宇称解。
- 交点：蓝线与红线的交点对应偶宇称能级，蓝线与绿线的交点对应奇宇称能级。每一个交点的横坐标 $$E$$ 就是一个允许的能级。
- 能级分布：能级分布不均匀，低能级间隔较大，高能级间隔逐渐变小，反映了有限深方势阱的物理特性。

### 3.2 能级计算结果

请列出您计算得到的前6个能级值，并与参考值进行比较：

| 能级序号 | 计算值 (eV) | 参考值 (eV) | 相对误差 (%) |
|---------|------------|------------|-------------|
| 0       |    0.318        | 0.318      |        0.0     |
| 1       |    1.270        | 1.270      |        0.0    |
| 2       |    2.851        | 2.851      |        0.0     |
| 3       |    5.050        | 5.050      |        0.0    |
| 4       |    7.850        | 7.850      |        0.0     |
| 5       |    11.215        | 11.215     |       0.0      |

## 4. 分析与讨论

### 4.1 能级分布规律

请分析计算得到的能级分布规律，特别是：
- 能级间隔是否均匀？随着能级增加，间隔如何变化？
- 这种分布规律与经典物理有何不同？体现了量子力学的哪些特性？

_ 能级间隔并不是均匀分布的。基态与第一激发态之间的能量差最大，随着能级编号的增加，能级之间的间隔逐渐减小。高能级越来越密集，最终在接近势阱高度 $$V$$ 时，能级间隔趋于零。
_ 在经典物理中，粒子在势阱内可以取任意能量，没有能级间隔的概念。而在量子力学中，粒子的能量只能取特定的离散值，即“量子化”现象。有限深方势阱只能容纳有限个束缚态能级，且能级数目和间隔都由势阱的深度和宽度决定。
### 4.2 计算方法的精度与效率

讨论您使用的二分法在求解此类问题时的优缺点：
- 计算精度如何？是否足以满足物理问题的需求？
- 计算效率如何？是否有可能使用其他方法（如牛顿法）提高效率？

_ 二分法优点在于精度可控、实现简单；缺点在于效率较低，二分法每次只将区间缩小一半，收敛速度较慢，尤其在高精度或大区间时，迭代次数较多。
_ 可替代方法:牛顿法等迭代法收敛速度更快，但要求函数连续且能方便地计算导数，且对初值敏感，容易陷入局部极值或发散，不适合多根、间断点多的超越方程;割线法、弦截法等可在不需要导数的情况下加快收敛，但鲁棒性仍不及二分法。
### 4.3 思考题

1. 如果增加势阱宽度 $w$，能级将如何变化？请给出物理解释。

_ 如果增加势阱宽度 $w$，能级将降低且间隔变小。物理上，势阱变宽后，粒子的德布罗意波长可以更长，动能减小，因此能级降低。同时，宽阱能容纳更多束缚态，能级分布更密集。

2. 如果将势阱高度 $$V$$ 改变，对能级分布有何影响？特别是，当 $$V \to \infty$$ 时，能级方程将如何简化？

_ 增大势阱高度 $V$，能级数目增多且各能级升高。当 $V \to \infty$ 时，方势阱变为无限深势阱，能级方程简化为 $k_n w = n\pi$，能级变为 $E_n = \frac{n^2\pi^2\hbar^2}{2mw^2}$，即能级完全均匀分布且无上限。

## 5. 结论

总结本实验的主要发现和收获，包括对量子力学基本概念的理解以及数值方法在物理问题中的应用。

_ 本实验通过数值方法求解有限深方势阱的能级问题，深入理解了量子力学中能级离散性、束缚态有限性等基本概念。实验发现，能级间隔随着能级升高逐渐变小，能级分布与经典连续能量不同，体现了量子化的本质。此外，实验还体会到偶宇称和奇宇称能级的物理意义及其在能级方程中的体现。
_ 在数值方法方面，掌握了二分法在超越方程求根中的应用，认识到其鲁棒性和精度优势，同时也了解了其效率和适用范围的局限。通过合理处理数值误差和边界条件，保证了计算结果的可靠性。整体上，实验不仅加深了对量子力学理论的理解，也提升了利用计算方法解决实际物理问题的能力。

## 核心代码片段

请粘贴您实现的关键函数代码（如二分法求解能级的函数），并简要说明代码的核心思路。

```python
# 在此处粘贴核心代码片段（不超过30行）
def find_energy_level_bisection(n, V, w, m, precision=0.001, E_min=0.001, E_max=None):
    """
    使用二分法求解方势阱中的第n个能级
    
    参数:
        n (int): 能级序号 (0表示基态，1表示第一激发态，以此类推)
        V (float): 势阱高度 (eV)
        w (float): 势阱宽度 (m)
        m (float): 粒子质量 (kg)
        precision (float): 求解精度 (eV)
        E_min (float): 能量搜索下限 (eV)
        E_max (float): 能量搜索上限 (eV)，默认为V
    
    返回:
        float: 第n个能级的能量值 (eV)
    """
    # TODO: 实现二分法求解能级的代码 (约25行代码)
    # [STUDENT_CODE_HERE]
    # 提示: 需要考虑能级的奇偶性，偶数能级使用偶宇称方程，奇数能级使用奇宇称方程
    
    if E_max is None:
        E_max = V - 1e-6  # 避免除零

    def even_func(E):
        E_joule = E * EV_TO_JOULE
        V_joule = V * EV_TO_JOULE
        factor = (w ** 2 * m) / (2 * HBAR ** 2)
        try:
            y1 = np.tan(np.sqrt(factor * E_joule))
            y2 = np.sqrt((V_joule - E_joule) / E_joule)
            return y1 - y2
        except Exception:
            return np.nan

    def odd_func(E):
        E_joule = E * EV_TO_JOULE
        V_joule = V * EV_TO_JOULE
        factor = (w ** 2 * m) / (2 * HBAR ** 2)
        try:
            y1 = np.tan(np.sqrt(factor * E_joule))
            y3 = -np.sqrt(E_joule / (V_joule - E_joule))
            return y1 - y3
        except Exception:
            return np.nan

    func = even_func if n % 2 == 0 else odd_func

    # 判断区间端点是否异号
    fa = func(E_min)
    fb = func(E_max)
    if np.isnan(fa) or np.isnan(fb):
        raise ValueError("区间端点函数值无效，请检查参数设置。")
    # 如果区间端点异号，直接用该区间
    if fa * fb < 0:
        a, b = E_min, E_max
    else:
        # 自动扫描，找到第n个根
        scan_points = 1000
        E_scan = np.linspace(E_min, E_max, scan_points)
        f_scan = func(E_scan)
        f_scan = np.where(np.isnan(f_scan), 1e6, f_scan)
        sign_changes = np.where(np.diff(np.sign(f_scan)))[0]
        if len(sign_changes) <= n:
            raise ValueError("指定区间内未找到足够的根，请检查参数设置。")
        a = E_scan[sign_changes[n]]
        b = E_scan[sign_changes[n] + 1]

    # 二分法
    while b - a > precision:
        mid = (a + b) / 2
        fm = func(mid)
        if np.isnan(fm):
            mid += precision * 0.1
            fm = func(mid)
        fa = func(a)
        if fa * fm < 0:
            b = mid
        else:
            a = mid
    energy_level = (a + b) / 2
    return energy_level
```

代码说明：使用二分法求解方势阱中的第n个能级
_在此处简要解释代码的实现思路（约100字）_
