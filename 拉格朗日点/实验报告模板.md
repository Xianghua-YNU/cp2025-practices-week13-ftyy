# 拉格朗日点 - 实验报告

## 1. 实验目的简述

本实验旨在通过数值方法求解地球-月球系统中L1拉格朗日点的位置，具体目标包括：
- 理解拉格朗日点的物理意义及其在天体力学中的重要性
- 推导L1点位置满足的方程
- 实现并比较不同的数值求根方法（牛顿法、弦截法）
- 分析数值方法的收敛性和精度

## 2. 方法简述

请简要描述您实现的算法和方法，特别是：
- L1点位置方程的推导过程和物理意义
- 牛顿法和弦截法的实现策略
- 初值或初始区间的选择依据
_在此处填写您的方法描述（约200-300字）_
```python
    # 地球引力
    earth_gravity = G * M / (r**2)
    # 月球引力 (注意方向与地球引力相反)
    moon_gravity = G * m / ((R - r)**2)
    # 离心力
    centrifugal_force = omega**2 * r
    # 力平衡方程
    return earth_gravity - moon_gravity - centrifugal_force
```
L1 是引力与离心力的平衡点，物体在此与两天体同步旋转。
牛顿法：牛顿法迭代公式：
![image](https://github.com/user-attachments/assets/91355cbf-9bc0-4eb9-b266-0b0d2715fed8)
通过计算导数，求得切线方程，通过切线和横轴的交点不断逼近零点，即L1
弦截法：迭代公式
![image](https://github.com/user-attachments/assets/59a532ea-e6a8-4317-a857-d7e7ef436b8d)
通过差分公式避免求导，通过弦和横轴交点不断逼近零点L1
## 3. 实验结果

### 3.1 L1点位置方程可视化

请在此处粘贴您生成的L1点位置方程图像，并简要说明图中的零点位置及其物理意义。
![lagrange](https://github.com/user-attachments/assets/487f8950-d143-4b7c-a5c8-9e90f27b53d1)
图像说明：
_在此处添加对图像的解释（约100字）_
如图，零点在3.26*10^8m处，即地月两体系统的L1点，此处是引力与离心力的平衡点，物体在此与两天体同步旋转。轻微扰动会使物体偏离L1，需主动维持位置。
初始值选择：
基于物理意义，L1靠近M2因此r 应接近R避免选择r靠近M1，否则可能导致方程f(r) 变化剧烈，迭代不稳定。
### 3.2 数值求解结果

请列出使用不同方法求解L1点位置的结果：

| 求解方法 | L1点位置 (m) | 相对于地月距离的比例 | 迭代次数 | 是否收敛 |
|---------|------------|-------------------|---------|--------|
| 牛顿法  |3.26045072e+08 m|0.848192  |   7      |  是      |
| 弦截法  |3.26044996e+08 m|0.848192  |   5      |   是     |
| fsolve  |3.26045072e+08 m| 0.848192 | -       | -      |

### 3.3 不同方法的结果比较

请计算不同方法之间的结果差异：

| 比较项 | 绝对差异 (m) | 相对差异 (%) |
|-------|------------|-------------|
| 牛顿法 vs 弦截法 |7.52047782e+01 m  | 0.00002307 |
| 牛顿法 vs fsolve |2.37822533e-05 m  | 0 |
| 弦截法 vs fsolve |7.52048020e+01 m  | 0.00002307 |

## 4. 分析与讨论

### 4.1 L1点的物理意义

请分析L1点的物理意义及其在空间任务中的应用价值：
- L1点为什么能保持卫星相对于地球和月球静止？
- 在L1点放置卫星有什么实际应用？
因为在L1点引力和离心力平衡，是引力与旋转效应平衡的临界点，在L1点卫星没有相对于两题系统的加速度。
应用：太阳观测卫星（SOHO）位于日地L1，持续监测太阳活动。
### 4.2 数值方法的比较

讨论牛顿法和弦截法在求解此问题时的优缺点：
- 收敛速度比较
- 对初值/初始区间的敏感性
- 计算复杂度和实现难度
牛顿法：
需要导数信息，收敛速度快（二阶收敛）。
弦截法：
无需导数，收敛速度稍慢（超线性收敛）。
需要两个初始点 
### 4.3 思考题

1. 如果将地球质量M增加，L1点的位置将如何变化？请给出物理解释。
L1更靠近地球
![image](https://github.com/user-attachments/assets/fa4745fc-418e-4e3c-a3b3-3ef993bec97d)

2. 除了L1点外，地球-月球系统还有其他拉格朗日点（L2-L5）。这些点的位置如何确定？它们各自有什么特点？
共线点（L1、L2、L3）：需数值求解，初始值依赖物理直觉（靠近较小天体）。均为不稳定平衡，需轨道修正维持位置。
三角点（L4、L5）：位置由几何决定，无需迭代。稳定平衡（地月质量比 > 25），可长期存留物质。
## 5. 结论

总结本实验的主要发现和收获，包括对拉格朗日点物理意义的理解以及数值方法在天体力学问题中的应用。
通过本实验，我了解了牛顿法和弦截法如何求解方程，其背后的原理、迭代方程以及两种方法各自的优劣。
同时巩固了拉格朗日点的概念，了解到如何在空间望远镜的设置上应用拉格朗日点。

## 核心代码片段

请粘贴您实现的关键函数代码（如L1点位置方程和牛顿法实现），并简要说明代码的核心思路。

```python
def newton_method(f, df, x0, tol=1e-8, max_iter=100):
    """
    使用牛顿法（切线法）求解方程f(x)=0
    
    参数:
        f (callable): 目标方程，形式为f(x)=0
        df (callable): 目标方程的导数
        x0 (float): 初始猜测值
        tol (float): 收敛容差
        max_iter (int): 最大迭代次数
    
    返回:
        tuple: (近似解, 迭代次数, 收敛标志)
    """
    x = x0
    converged = False
    for iterations in range(1, max_iter + 1):
        fx = f(x)
        dfx = df(x)
        if abs(dfx) < 1e-14:  # 避免除以零
            break
        x_new = x - fx / dfx
        if abs(x_new - x) < tol:
            x = x_new
            converged = True
            break
        x = x_new
    else:
        iterations = max_iter
    return x, iterations, converged
def secant_method(f, a, b, tol=1e-8, max_iter=100):
    """
    使用弦截法求解方程f(x)=0
    
    参数:
        f (callable): 目标方程，形式为f(x)=0
        a (float): 区间左端点
        b (float): 区间右端点
        tol (float): 收敛容差
        max_iter (int): 最大迭代次数
    
    返回:
        tuple: (近似解, 迭代次数, 收敛标志)
    """
    fa = f(a)
    fb = f(b)
    
    if abs(fa) < tol:
        return a, 0, True
    if abs(fb) < tol:
        return b, 0, True
    
    if fa * fb > 0:  # 确保区间端点函数值异号
        print("警告: 区间端点函数值同号，弦截法可能不收敛")
    
    iterations = 0
    converged = False
    
    x0, x1 = a, b
    f0, f1 = fa, fb
    
    for i in range(max_iter):
        # 避免除以接近零的数
        if abs(f1 - f0) < 1e-14:
            break
        
        # 弦截法迭代公式
        x2 = x1 - f1 * (x1 - x0) / (f1 - f0)
        f2 = f(x2)
        
        if abs(f2) < tol:  # 函数值接近零
            converged = True
            iterations = i + 1
            x1 = x2
            break
        
        # 检查相对变化是否小于容差
        if abs((x2 - x1) / x1) < tol:
            converged = True
            iterations = i + 1
            x1 = x2
            break
        
        # 更新迭代值
        x0, f0 = x1, f1
        x1, f1 = x2, f2
        iterations = i + 1
    
    return x1, iterations, converged
```

代码说明：
_在此处简要解释代码的实现思路（约100字）_
